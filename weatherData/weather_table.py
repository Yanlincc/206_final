data = {'al': {'q1': 58.81944444444445, 'q2': 68.51388888888889, 'q3': 78.81944444444444, 'q4': 58.68055555555555}, 'ak': {'q1': 4.3092694857103355, 'q2': 38.261016455092, 'q3': 55.99795933809847, 'q4': 21.298907646474678}, 'az': {'q1': 37.00534241674024, 'q2': 60.119823232323235, 'q3': 72.36647591348803, 'q4': 52.34528243327126}, 'ar': {'q1': 0, 'q2': 61.833333333333336, 'q3': 79.19047619047619, 'q4': 55.214285714285715}, 'ca': {'q1': 42.77396926773182, 'q2': 57.7600777313428, 'q3': 73.55198285101822, 'q4': 48.319045232985765}, 'co': {'q1': 19.25389804318995, 'q2': 0, 'q3': 59.09208758028421, 'q4': 37.59172143731995}, 'ct': {'q1': 37.166666666666664, 'q2': 54.75, 'q3': 74.25, 'q4': 51.833333333333336}, 'de': {'q1': 0, 'q2': 0, 'q3': 0, 'q4': 0}, 'fl': {'q1': 65.875, 'q2': 74.91071428571429, 'q3': 81.96318342151676, 'q4': 71.97023809523809}, 'ga': {'q1': 57.641798941798946, 'q2': 68.68981481481482, 'q3': 77.43055555555554, 'q4': 58.235391981518745}, 'hi': {'q1': 66.70454545454545, 'q2': 69.26811594202898, 'q3': 72.01449275362319, 'q4': 70.76086956521739}, 'id': {'q1': 20.9043351080309, 'q2': 43.05054347949693, 'q3': 67.72309883384803, 'q4': 35.05024124620899}, 'il': {'q1': 38.40740740740741, 'q2': 56.05555555555555, 'q3': 76.22222222222221, 'q4': 50.44444444444445}, 'in': {'q1': 42.875, 'q2': 56.270833333333336, 'q3': 75.3125, 'q4': 50.166666666666664}, 'ia': {'q1': 25.25, 'q2': 50.208333333333336, 'q3': 75.97916666666667, 'q4': 50.083333333333336}, 'ks': {'q1': 31.98148148148148, 'q2': 55.02178649237473, 'q3': 79.5, 'q4': 57.34814814814814}, 'ky': {'q1': 50.32222222222222, 'q2': 61.76666666666667, 'q3': 0, 'q4': 51.53333333333333}, 'la': {'q1': 58.583333333333336, 'q2': 71.98703703703704, 'q3': 80.5037037037037, 'q4': 60.63333333333333}, 'me': {'q1': 0, 'q2': 49.13333333333333, 'q3': 68.93333333333334, 'q4': 45.72777777777778}, 'md': {'q1': 45.55555555555555, 'q2': 64.3888888888889, 'q3': 78.94444444444444, 'q4': 54.666666666666664}, 'ma': {'q1': 35.25, 'q2': 52.5, 'q3': 72.58333333333333, 'q4': 50.333333333333336}, 'mi': {'q1': 23.57843137254902, 'q2': 46.51960784313726, 'q3': 68.50980392156863, 'q4': 44.51960784313726}, 'mn': {'q1': 2.9444444444444446, 'q2': 43.313131313131315, 'q3': 67.510101010101, 'q4': 43.33664772727273}, 'ms': {'q1': 58.46296296296296, 'q2': 70.25925925925925, 'q3': 78.93518518518518, 'q4': 59.574074074074076}, 'mo': {'q1': 39.97551415483104, 'q2': 57.40196078431372, 'q3': 78.32352941176471, 'q4': 53.764705882352935}, 'mt': {'q1': 18.03359841397131, 'q2': 41.36583870653731, 'q3': 66.3951950453477, 'q4': 33.866226077030674}, 'ne': {'q1': 25.654358974358974, 'q2': 0, 'q3': 77.43589743589745, 'q4': 0}, 'nv': {'q1': 27.164739438791244, 'q2': 47.540665751544275, 'q3': 70.05998347115883, 'q4': 38.48588770327901}, 'nh': {'q1': 22.5, 'q2': 43.611111111111114, 'q3': 62.166666666666664, 'q4': 40.422222222222224}, 'nj': {'q1': 42.583333333333336, 'q2': 59.333333333333336, 'q3': 77.41666666666667, 'q4': 52.833333333333336}, 'nm': {'q1': 28.40311986863711, 'q2': 49.38027914614122, 'q3': 61.00513285024155, 'q4': 43.5625}, 'ny': {'q1': 33.607142857142854, 'q2': 53.702380952380956, 'q3': 71.90476190476191, 'q4': 48.46230158730159}, 'nc': {'q1': 52.5088855979267, 'q2': 67.40090090090091, 'q3': 76.41441441441442, 'q4': 54.1036036036036}, 'nd': {'q1': 2.859890109890111, 'q2': 44.82875457875457, 'q3': 70.19047619047619, 'q4': 40.175983436853}, 'oh': {'q1': 41.09259259259259, 'q2': 57.537037037037045, 'q3': 75.2962962962963, 'q4': 48.53703703703704}, 'ok': {'q1': 41.88095238095238, 'q2': 62.595238095238095, 'q3': 81.5952380952381, 'q4': 58.11904761904762}, 'or': {'q1': 30.953932893289323, 'q2': 45.81769804563922, 'q3': 67.72931283276111, 'q4': 38.3317487099646}, 'pa': {'q1': 38.904761904761905, 'q2': 57.357142857142854, 'q3': 73.78571428571429, 'q4': 48.67857142857142}, 'ri': {'q1': 37.5, 'q2': 54.833333333333336, 'q3': 73.66666666666667, 'q4': 0}, 'sc': {'q1': 55.729166666666664, 'q2': 0, 'q3': 78.375, 'q4': 56.75297619047618}, 'sd': {'q1': 19.493386243386244, 'q2': 45.620370370370374, 'q3': 74.26851851851852, 'q4': 48.65740740740741}, 'tn': {'q1': 52.701897018970186, 'q2': 64.22222222222221, 'q3': 77.1111111111111, 'q4': 53.3968253968254}, 'tx': {'q1': 52.810810810810814, 'q2': 72.70945945945947, 'q3': 83.19270640503517, 'q4': 62.42567567567568}, 'ut': {'q1': 20.34386162786804, 'q2': 0, 'q3': 64.43251208230966, 'q4': 37.16097206119712}, 'vt': {'q1': 24.833333333333332, 'q2': 49.166666666666664, 'q3': 68.375, 'q4': 43.833333333333336}, 'va': {'q1': 47.730769230769226, 'q2': 64.26923076923077, 'q3': 77.06410256410257, 'q4': 52.43589743589743}, 'wa': {'q1': 27.702468126468187, 'q2': 44.22937893713271, 'q3': 64.72991673844386, 'q4': 37.708858858858854}, 'wv': {'q1': 46.5, 'q2': 58.86666666666667, 'q3': 72.16666666666667, 'q4': 46.900000000000006}, 'wi': {'q1': 19.0, 'q2': 48.5, 'q3': 72.48148148148148, 'q4': 46.61111111111111}, 'wy': {'q1': 16.211999647328515, 'q2': 37.375356017450336, 'q3': 60.68097925116087, 'q4': 32.875786163522015}}

import sqlite3

def create_weather_table():

    conn = sqlite3.connect('../database.db')

    cursor = conn.cursor()

    create_table_query = '''
        CREATE TABLE IF NOT EXISTS quarterly_temp (
            id INTEGER PRIMARY KEY,
            state_abbr TEXT,
            q1_temp REAL,
            q2_temp REAL,
            q3_temp REAL,
            q4_temp REAL
        )
    '''
    cursor.execute(create_table_query)

    conn.commit()
    conn.close()

def insert_weather_data(id, state, t1, t2, t3, t4):
    conn = sqlite3.connect('../database.db')
    cursor = conn.cursor()
    cursor.execute('''
        INSERT OR REPLACE INTO quarterly_temp (id, state_abbr, q1_temp, q2_temp, q3_temp, q4_temp)
        VALUES (?, ?, ?, ?, ?, ?)
    ''', (id, state, t1, t2, t3, t4))
    conn.commit()
    conn.close()

def construct_weather_table():
    global data
    create_weather_table()
    print(data)
    id = 0
    for i, j in data.items():
        id+=1
        insert_weather_data(id, i, j['q1'], j['q2'], j['q3'], j['q4'])

construct_weather_table()